"use strict";(self["webpackChunkrest"]=self["webpackChunkrest"]||[]).push([[426],{4426:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var r=n(3396),a=n(7139);const s=e=>((0,r.dD)("data-v-ae85156a"),e=e(),(0,r.Cn)(),e),c={class:"container text-center mt-5"},i=s((()=>(0,r._)("h2",null,"🎉 Payment Status",-1))),o={key:0},l={key:1},d=s((()=>(0,r._)("p",{class:"text-success"},"✅ Payment successful!",-1))),f=s((()=>(0,r._)("strong",null,"Reference:",-1))),u={key:2},g=s((()=>(0,r._)("p",{class:"text-danger"},"❌ Payment verification failed.",-1))),h=[g];function p(e,t,n,s,g,p){const m=(0,r.up)("qrcode-vue"),v=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",c,[i,g.loading?((0,r.wg)(),(0,r.iD)("div",o,"Verifying payment...")):g.verified?((0,r.wg)(),(0,r.iD)("div",l,[d,(0,r._)("p",null,[f,(0,r.Uk)(" "+(0,a.zw)(g.reference),1)]),(0,r.Wm)(m,{value:g.reference,size:200},null,8,["value"])])):((0,r.wg)(),(0,r.iD)("div",u,h)),(0,r.Wm)(v,{to:"/",class:"btn btn-primary mt-3"},{default:(0,r.w5)((()=>[(0,r.Uk)("Go Home")])),_:1})])}var m=n(4161),v=n(65),y=n(85),k={name:"PaymentSuccess",components:{QrcodeVue:y.ZP},data(){return{reference:"",verified:!1,loading:!0}},computed:{...(0,v.Se)(["getContactInfo","getCart","getSelectedTickets","getCartTotal"])},methods:{async sendOrderInfo(){try{const e=localStorage.getItem("paystack_reference"),t={reference:e,title:this.getCart[0]?.title,contact:{email:this.getContactInfo.email,phone:this.getContactInfo.phone},userId:this.getCart[0]?.user,tickets:this.getSelectedTickets,price:this.getCartTotal};console.log("Sending order info:",t);const n=await m.Z.post("https://event-ticket-qa70.onrender.com/api/order",t);console.log("Order info sent:",n.data)}catch(e){console.error("Failed to send order info:",e)}}},async mounted(){if(this.reference=localStorage.getItem("paystack_reference"),this.reference)try{const e=await m.Z.get(`https://event-ticket-qa70.onrender.com/api/verify/${this.reference}`);"success"===e.data.data.status&&(this.verified=!0,await this.sendOrderInfo())}catch(e){console.error("Verification error:",e)}finally{this.loading=!1}else this.loading=!1}},w=n(89);const C=(0,w.Z)(k,[["render",p],["__scopeId","data-v-ae85156a"]]);var _=C}}]);
//# sourceMappingURL=426.17e2a6ee.js.map