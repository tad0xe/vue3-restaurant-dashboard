{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, renderList as _renderList, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-f74ef508\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container mt-4\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Categories\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  class: \"mb-2\"\n};\nconst _hoisted_4 = {\n  class: \"mb-2\"\n};\nconst _hoisted_5 = [\"required\"];\nconst _hoisted_6 = {\n  type: \"submit\",\n  class: \"btn btn-success me-2\"\n};\nconst _hoisted_7 = {\n  class: \"table table-bordered\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"Type\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Photo\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Actions\")])], -1 /* HOISTED */));\nconst _hoisted_9 = [\"src\"];\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createCommentVNode(\" Form \"), _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers($event => $data.isEditing ? $options.updateCategory() : $options.createCategory(), [\"prevent\"])),\n    class: \"mb-4\"\n  }, [_createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.form.type = $event),\n    type: \"text\",\n    placeholder: \"Category type\",\n    class: \"form-control\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.form.type]])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"input\", {\n    type: \"file\",\n    onChange: _cache[1] || (_cache[1] = (...args) => $options.handlePhoto && $options.handlePhoto(...args)),\n    class: \"form-control\",\n    required: !$data.isEditing\n  }, null, 40 /* PROPS, HYDRATE_EVENTS */, _hoisted_5)]), _createElementVNode(\"button\", _hoisted_6, _toDisplayString($data.isEditing ? \"Update\" : \"Create\"), 1 /* TEXT */), $data.isEditing ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    type: \"button\",\n    class: \"btn btn-secondary\",\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.cancelEdit && $options.cancelEdit(...args))\n  }, \"Cancel\")) : _createCommentVNode(\"v-if\", true)], 32 /* HYDRATE_EVENTS */), _createCommentVNode(\" Categories Table \"), _createElementVNode(\"table\", _hoisted_7, [_hoisted_8, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, category => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: category._id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(category.type), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"img\", {\n      src: category.photo,\n      alt: \"Category photo\",\n      width: \"80\"\n    }, null, 8 /* PROPS */, _hoisted_9)]), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      class: \"btn btn-sm btn-primary me-2\",\n      onClick: $event => $options.editCategory(category)\n    }, \"Edit\", 8 /* PROPS */, _hoisted_10), _createElementVNode(\"button\", {\n      class: \"btn btn-sm btn-danger\",\n      onClick: $event => $options.deleteCategory(category._id)\n    }, \"Delete\", 8 /* PROPS */, _hoisted_11)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","type","_createElementBlock","_hoisted_1","_hoisted_2","_createCommentVNode","onSubmit","_cache","_withModifiers","$event","$data","isEditing","$options","updateCategory","createCategory","_hoisted_3","form","placeholder","required","_hoisted_4","onChange","args","handlePhoto","_hoisted_6","_toDisplayString","onClick","cancelEdit","_hoisted_7","_hoisted_8","_Fragment","_renderList","categories","category","key","_id","src","photo","alt","width","editCategory","_hoisted_10","deleteCategory","_hoisted_11"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\event-ticket-frontend\\src\\components\\app\\admin\\category.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mt-4\">\r\n    <h2>Categories</h2>\r\n\r\n    <!-- Form -->\r\n    <form @submit.prevent=\"isEditing ? updateCategory() : createCategory()\" class=\"mb-4\">\r\n      <div class=\"mb-2\">\r\n        <input v-model=\"form.type\" type=\"text\" placeholder=\"Category type\" class=\"form-control\" required />\r\n      </div>\r\n      <div class=\"mb-2\">\r\n        <input type=\"file\" @change=\"handlePhoto\" class=\"form-control\" :required=\"!isEditing\" />\r\n      </div>\r\n      <button type=\"submit\" class=\"btn btn-success me-2\">\r\n        {{ isEditing ? \"Update\" : \"Create\" }}\r\n      </button>\r\n      <button type=\"button\" v-if=\"isEditing\" class=\"btn btn-secondary\" @click=\"cancelEdit\">Cancel</button>\r\n    </form>\r\n\r\n    <!-- Categories Table -->\r\n    <table class=\"table table-bordered\">\r\n      <thead>\r\n        <tr>\r\n          <th>Type</th>\r\n          <th>Photo</th>\r\n          <th>Actions</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"category in categories\" :key=\"category._id\">\r\n          <td>{{ category.type }}</td>\r\n          <td>\r\n            <img :src=\"category.photo\" alt=\"Category photo\" width=\"80\" />\r\n          </td>\r\n          <td>\r\n            <button class=\"btn btn-sm btn-primary me-2\" @click=\"editCategory(category)\">Edit</button>\r\n            <button class=\"btn btn-sm btn-danger\" @click=\"deleteCategory(category._id)\">Delete</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"CategoryManager\",\r\n  data() {\r\n    return {\r\n      API: \"http://localhost:4000/api\",\r\n      categories: [],\r\n      form: {\r\n        type: \"\",\r\n        photo: null,\r\n        _id: null,\r\n      },\r\n      isEditing: false,\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchCategories() {\r\n      try {\r\n        const res = await axios.get(`${this.API}/categories`);\r\n        this.categories = res.data.categories;\r\n      } catch (err) {\r\n        console.error(\"Error fetching categories:\", err.message);\r\n      }\r\n    },\r\n    handlePhoto(event) {\r\n      this.form.photo = event.target.files[0];\r\n    },\r\n    async createCategory() {\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"type\", this.form.type);\r\n        formData.append(\"photo\", this.form.photo);\r\n\r\n        await axios.post(`${this.API}/categories`, formData, {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" },\r\n        });\r\n\r\n        this.resetForm();\r\n        this.fetchCategories();\r\n      } catch (err) {\r\n        console.error(\"Error creating category:\", err.message);\r\n      }\r\n    },\r\n    editCategory(category) {\r\n      this.form.type = category.type;\r\n      this.form._id = category._id;\r\n      this.form.photo = null; // Will not re-upload unless changed\r\n      this.isEditing = true;\r\n    },\r\n    async updateCategory() {\r\n      try {\r\n        // If photo is not changed, send existing URL\r\n        let photoUrl = this.categories.find(c => c._id === this.form._id)?.photo;\r\n\r\n        await axios.put(`${this.API}/categories/${this.form._id}`, {\r\n          type: this.form.type,\r\n          photo: photoUrl, // backend expects a string for photo in PUT\r\n        });\r\n\r\n        this.resetForm();\r\n        this.fetchCategories();\r\n      } catch (err) {\r\n        console.error(\"Error updating category:\", err.message);\r\n      }\r\n    },\r\n    async deleteCategory(id) {\r\n      if (!confirm(\"Are you sure you want to delete this category?\")) return;\r\n\r\n      try {\r\n        await axios.delete(`${this.API}/categories/${id}`);\r\n        this.fetchCategories();\r\n      } catch (err) {\r\n        console.error(\"Error deleting category:\", err.message);\r\n      }\r\n    },\r\n    cancelEdit() {\r\n      this.resetForm();\r\n    },\r\n    resetForm() {\r\n      this.form = { type: \"\", photo: null, _id: null };\r\n      this.isEditing = false;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fetchCategories();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nimg {\r\n  object-fit: cover;\r\n  border-radius: 4px;\r\n}\r\n</style>\r\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAgB;gEACzBC,mBAAA,CAAmB,YAAf,YAAU;;EAIPD,KAAK,EAAC;AAAM;;EAGZA,KAAK,EAAC;AAAM;;;EAGTE,IAAI,EAAC,QAAQ;EAACF,KAAK,EAAC;;;EAOvBA,KAAK,EAAC;AAAsB;gEACjCC,mBAAA,CAMQ,gB,aALNA,mBAAA,CAIK,a,aAHHA,mBAAA,CAAa,YAAT,MAAI,G,aACRA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAgB,YAAZ,SAAO,E;;;;;uBAvBnBE,mBAAA,CAuCM,OAvCNC,UAuCM,GAtCJC,UAAmB,EAEnBC,mBAAA,UAAa,EACbL,mBAAA,CAWO;IAXAM,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,CAAAC,MAAA,IAAUC,KAAA,CAAAC,SAAS,GAAGC,QAAA,CAAAC,cAAc,KAAKD,QAAA,CAAAE,cAAc;IAAIf,KAAK,EAAC;MAC5EC,mBAAA,CAEM,OAFNe,UAEM,G,gBADJf,mBAAA,CAAmG;+DAAnFU,KAAA,CAAAM,IAAI,CAACf,IAAI,GAAAQ,MAAA;IAAER,IAAI,EAAC,MAAM;IAACgB,WAAW,EAAC,eAAe;IAAClB,KAAK,EAAC,cAAc;IAACmB,QAAQ,EAAR;iDAAxER,KAAA,CAAAM,IAAI,CAACf,IAAI,E,KAE3BD,mBAAA,CAEM,OAFNmB,UAEM,GADJnB,mBAAA,CAAuF;IAAhFC,IAAI,EAAC,MAAM;IAAEmB,QAAM,EAAAb,MAAA,QAAAA,MAAA,UAAAc,IAAA,KAAET,QAAA,CAAAU,WAAA,IAAAV,QAAA,CAAAU,WAAA,IAAAD,IAAA,CAAW;IAAEtB,KAAK,EAAC,cAAc;IAAEmB,QAAQ,GAAGR,KAAA,CAAAC;0DAE5EX,mBAAA,CAES,UAFTuB,UAES,EAAAC,gBAAA,CADJd,KAAA,CAAAC,SAAS,wCAEcD,KAAA,CAAAC,SAAS,I,cAArCT,mBAAA,CAAoG;;IAA5FD,IAAI,EAAC,QAAQ;IAAkBF,KAAK,EAAC,mBAAmB;IAAE0B,OAAK,EAAAlB,MAAA,QAAAA,MAAA,UAAAc,IAAA,KAAET,QAAA,CAAAc,UAAA,IAAAd,QAAA,CAAAc,UAAA,IAAAL,IAAA,CAAU;KAAE,QAAM,K,8DAG7FhB,mBAAA,sBAAyB,EACzBL,mBAAA,CAoBQ,SApBR2B,UAoBQ,GAnBNC,UAMQ,EACR5B,mBAAA,CAWQ,iB,kBAVNE,mBAAA,CASK2B,SAAA,QAAAC,WAAA,CATkBpB,KAAA,CAAAqB,UAAU,EAAtBC,QAAQ;yBAAnB9B,mBAAA,CASK;MAT+B+B,GAAG,EAAED,QAAQ,CAACE;QAChDlC,mBAAA,CAA4B,YAAAwB,gBAAA,CAArBQ,QAAQ,CAAC/B,IAAI,kBACpBD,mBAAA,CAEK,aADHA,mBAAA,CAA6D;MAAvDmC,GAAG,EAAEH,QAAQ,CAACI,KAAK;MAAEC,GAAG,EAAC,gBAAgB;MAACC,KAAK,EAAC;2CAExDtC,mBAAA,CAGK,aAFHA,mBAAA,CAAyF;MAAjFD,KAAK,EAAC,6BAA6B;MAAE0B,OAAK,EAAAhB,MAAA,IAAEG,QAAA,CAAA2B,YAAY,CAACP,QAAQ;OAAG,MAAI,iBAAAQ,WAAA,GAChFxC,mBAAA,CAA2F;MAAnFD,KAAK,EAAC,uBAAuB;MAAE0B,OAAK,EAAAhB,MAAA,IAAEG,QAAA,CAAA6B,cAAc,CAACT,QAAQ,CAACE,GAAG;OAAG,QAAM,iBAAAQ,WAAA,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}