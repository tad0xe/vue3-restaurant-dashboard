{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = [\"value\"];\nconst _hoisted_2 = [\"value\"];\nconst _hoisted_3 = {\n  key: 0,\n  style: {\n    \"color\": \"red\",\n    \"font-weight\": \"bold\"\n  }\n};\nconst _hoisted_4 = {\n  key: 1\n};\nconst _hoisted_5 = {\n  key: 2\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"h3\", null, \"🎟 Order Details\", -1 /* HOISTED */);\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"strong\", null, \"Title:\", -1 /* HOISTED */);\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"strong\", null, \"Email:\", -1 /* HOISTED */);\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"strong\", null, \"Phone:\", -1 /* HOISTED */);\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"strong\", null, \"Price:\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_qrcode_stream = _resolveComponent(\"qrcode-stream\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createCommentVNode(\" Camera selection \"), _createElementVNode(\"p\", null, [_createTextVNode(\" Select Camera: \"), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.selectedConstraints = $event)\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.constraintOptions, option => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: option.label,\n      value: option.constraints\n    }, _toDisplayString(option.label), 9 /* TEXT, PROPS */, _hoisted_1);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.selectedConstraints]])]), _createCommentVNode(\" Track function selection \"), _createElementVNode(\"p\", null, [_createTextVNode(\" Highlight mode: \"), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.trackFunctionSelected = $event)\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.trackFunctionOptions, option => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: option.text,\n      value: option\n    }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_2);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.trackFunctionSelected]])]), _createCommentVNode(\" QR Scanner \"), _createVNode(_component_qrcode_stream, {\n    constraints: $data.selectedConstraints,\n    track: $data.trackFunctionSelected.value,\n    formats: $options.selectedBarcodeFormats,\n    onDecode: $options.onDecode,\n    onInit: $options.onInit,\n    onError: $options.onError,\n    onCameraOn: $options.onCameraReady\n  }, null, 8 /* PROPS */, [\"constraints\", \"track\", \"formats\", \"onDecode\", \"onInit\", \"onError\", \"onCameraOn\"]), _createCommentVNode(\" Error display \"), $data.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, \"Error: \" + _toDisplayString($data.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Scanned Reference \"), $data.reference ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, [_createTextVNode(\"Scanned Reference: \"), _createElementVNode(\"strong\", null, _toDisplayString($data.reference), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Order Info \"), $data.orderData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"p\", null, [_hoisted_7, _createTextVNode(\" \" + _toDisplayString($data.orderData.title), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_8, _createTextVNode(\" \" + _toDisplayString($data.orderData.contact.email), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_9, _createTextVNode(\" \" + _toDisplayString($data.orderData.contact.phone), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_10, _createTextVNode(\" ₦\" + _toDisplayString($data.orderData.price), 1 /* TEXT */)]), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.orderData.tickets, ticket => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: ticket.name\n    }, _toDisplayString(ticket.name) + \" × \" + _toDisplayString(ticket.quantity), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["style","_createElementVNode","_createElementBlock","_createCommentVNode","$data","selectedConstraints","$event","_Fragment","_renderList","constraintOptions","option","key","label","value","constraints","_hoisted_1","trackFunctionSelected","trackFunctionOptions","text","_hoisted_2","_createVNode","_component_qrcode_stream","track","formats","$options","selectedBarcodeFormats","onDecode","onInit","onError","onCameraOn","onCameraReady","error","_hoisted_3","_toDisplayString","reference","_hoisted_4","orderData","_hoisted_5","_hoisted_6","_hoisted_7","title","_hoisted_8","contact","email","_hoisted_9","phone","_hoisted_10","price","tickets","ticket","name","quantity"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\event-ticket-frontend\\src\\components\\rex.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- Camera selection -->\r\n    <p>\r\n      Select Camera:\r\n      <select v-model=\"selectedConstraints\">\r\n        <option\r\n          v-for=\"option in constraintOptions\"\r\n          :key=\"option.label\"\r\n          :value=\"option.constraints\"\r\n        >\r\n          {{ option.label }}\r\n        </option>\r\n      </select>\r\n    </p>\r\n\r\n    <!-- Track function selection -->\r\n    <p>\r\n      Highlight mode:\r\n      <select v-model=\"trackFunctionSelected\">\r\n        <option\r\n          v-for=\"option in trackFunctionOptions\"\r\n          :key=\"option.text\"\r\n          :value=\"option\"\r\n        >\r\n          {{ option.text }}\r\n        </option>\r\n      </select>\r\n    </p>\r\n\r\n    <!-- QR Scanner -->\r\n    <qrcode-stream\r\n      :constraints=\"selectedConstraints\"\r\n      :track=\"trackFunctionSelected.value\"\r\n      :formats=\"selectedBarcodeFormats\"\r\n      @decode=\"onDecode\"\r\n      @init=\"onInit\"\r\n      @error=\"onError\"\r\n      @camera-on=\"onCameraReady\"\r\n    />\r\n\r\n    <!-- Error display -->\r\n    <p v-if=\"error\" style=\"color: red; font-weight: bold;\">Error: {{ error }}</p>\r\n\r\n    <!-- Scanned Reference -->\r\n    <p v-if=\"reference\">Scanned Reference: <strong>{{ reference }}</strong></p>\r\n\r\n    <!-- Order Info -->\r\n    <div v-if=\"orderData\">\r\n      <h3>🎟 Order Details</h3>\r\n      <p><strong>Title:</strong> {{ orderData.title }}</p>\r\n      <p><strong>Email:</strong> {{ orderData.contact.email }}</p>\r\n      <p><strong>Phone:</strong> {{ orderData.contact.phone }}</p>\r\n      <p><strong>Price:</strong> ₦{{ orderData.price }}</p>\r\n      <ul>\r\n        <li v-for=\"ticket in orderData.tickets\" :key=\"ticket.name\">\r\n          {{ ticket.name }} × {{ ticket.quantity }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QrcodeStream } from \"vue-qrcode-reader\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  components: { QrcodeStream },\r\n  data() {\r\n    return {\r\n      reference: null,\r\n      orderData: null,\r\n      error: \"\",\r\n      selectedConstraints: { facingMode: \"environment\" },\r\n      constraintOptions: [\r\n        { label: \"Rear camera\", constraints: { facingMode: \"environment\" } },\r\n        { label: \"Front camera\", constraints: { facingMode: \"user\" } }\r\n      ],\r\n      trackFunctionOptions: [], // to be populated in created()\r\n      trackFunctionSelected: null,\r\n    };\r\n  },\r\n  computed: {\r\n    selectedBarcodeFormats() {\r\n      return [\"qr_code\"];\r\n    }\r\n  },\r\n  created() {\r\n    // Initialize track options here where methods are accessible\r\n    this.trackFunctionOptions = [\r\n      { text: \"Nothing (default)\", value: undefined },\r\n      { text: \"Outline\", value: this.paintOutline },\r\n      { text: \"Centered Text\", value: this.paintCenterText },\r\n      { text: \"Bounding Box\", value: this.paintBoundingBox }\r\n    ];\r\n    this.trackFunctionSelected = this.trackFunctionOptions[2]; // Centered Text by default\r\n\r\n    console.log(\"✅ Vue component created\");\r\n  },\r\n  mounted() {\r\n    console.log(\"✅ Component mounted\");\r\n  },\r\n  methods: {\r\n    async onDecode(ref) {\r\n      this.reference = ref;\r\n      console.log(\"🔍 Scanned reference:\", ref);\r\n      try {\r\n        const res = await axios.get(`http://localhost:4000/api/order/${ref}`);\r\n        console.log(\"📦 API response:\", res.data);\r\n        if (res.data && res.data.success) {\r\n          this.orderData = res.data.order;\r\n        } else {\r\n          alert(\"❌ Order not found: \" + (res.data.error || \"Unknown error\"));\r\n          this.orderData = null;\r\n        }\r\n      } catch (err) {\r\n        alert(\"⚠️ Error fetching order: \" + err.message);\r\n        console.error(\"❗ Fetch error:\", err);\r\n        this.orderData = null;\r\n      }\r\n    },\r\n\r\n    onInit(promise) {\r\n      promise\r\n        .then(() => {\r\n          console.log(\"📷 Camera initialized\");\r\n          this.error = \"\";\r\n        })\r\n        .catch((e) => {\r\n          console.error(\"🚫 Camera error:\", e);\r\n          this.error = e.message || \"Camera initialization failed\";\r\n        });\r\n    },\r\n\r\n    onError(err) {\r\n      console.error(\"⚠️ Error event:\", err);\r\n      this.error = err.message || \"Unknown error\";\r\n    },\r\n\r\n    async onCameraReady() {\r\n      try {\r\n        const devices = await navigator.mediaDevices.enumerateDevices();\r\n        const videoDevices = devices.filter((d) => d.kind === \"videoinput\");\r\n\r\n        // Add detected cameras to selection options\r\n        this.constraintOptions = [\r\n          { label: \"Rear camera\", constraints: { facingMode: \"environment\" } },\r\n          { label: \"Front camera\", constraints: { facingMode: \"user\" } },\r\n          ...videoDevices.map(({ deviceId, label }) => ({\r\n            label: `${label || \"Camera\"} (ID: ${deviceId})`,\r\n            constraints: { deviceId }\r\n          }))\r\n        ];\r\n        console.log(\"📸 Available cameras:\", this.constraintOptions);\r\n        this.error = \"\";\r\n      } catch (err) {\r\n        console.error(\"❌ Failed to enumerate devices\", err);\r\n        this.error = \"Failed to enumerate devices\";\r\n      }\r\n    },\r\n\r\n    paintOutline(detectedCodes, ctx) {\r\n      for (const detectedCode of detectedCodes) {\r\n        const [firstPoint, ...otherPoints] = detectedCode.cornerPoints;\r\n        ctx.strokeStyle = \"red\";\r\n        ctx.beginPath();\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        for (const { x, y } of otherPoints) {\r\n          ctx.lineTo(x, y);\r\n        }\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n      }\r\n    },\r\n\r\n    paintBoundingBox(detectedCodes, ctx) {\r\n      for (const detectedCode of detectedCodes) {\r\n        const {\r\n          boundingBox: { x, y, width, height }\r\n        } = detectedCode;\r\n        ctx.lineWidth = 2;\r\n        ctx.strokeStyle = \"#007bff\";\r\n        ctx.strokeRect(x, y, width, height);\r\n      }\r\n    },\r\n\r\n    paintCenterText(detectedCodes, ctx) {\r\n      for (const detectedCode of detectedCodes) {\r\n        const { boundingBox, rawValue } = detectedCode;\r\n        const centerX = boundingBox.x + boundingBox.width / 2;\r\n        const centerY = boundingBox.y + boundingBox.height / 2;\r\n        const fontSize = Math.max(\r\n          12,\r\n          (50 * boundingBox.width) / ctx.canvas.width\r\n        );\r\n        ctx.font = `bold ${fontSize}px sans-serif`;\r\n        ctx.textAlign = \"center\";\r\n        ctx.lineWidth = 3;\r\n        ctx.strokeStyle = \"#35495e\";\r\n        ctx.strokeText(rawValue, centerX, centerY);\r\n        ctx.fillStyle = \"#5cb984\";\r\n        ctx.fillText(rawValue, centerX, centerY);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}