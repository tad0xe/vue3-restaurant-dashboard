{"ast":null,"code":"import { mapGetters } from \"vuex\";\nexport default {\n  computed: {\n    ...mapGetters([\"getUsersWithAddresses\", \"getUsers\", \"getOrders\", \"error\"]),\n    usersWithAddresses() {\n      return this.getUsersWithAddresses;\n    },\n    user() {\n      return this.getUsers;\n    },\n    orders() {\n      return this.getOrders;\n    },\n    userOrderTotals() {\n      // Calculate total order price for each user\n      const userOrderTotals = {};\n      this.orders.forEach(order => {\n        const userId = order.owner;\n        const totalPrice = order.products.reduce((total, product) => {\n          return total + product.totalPrice;\n        }, 0);\n        if (userOrderTotals.hasOwnProperty(userId)) {\n          userOrderTotals[userId] += totalPrice;\n        } else {\n          userOrderTotals[userId] = totalPrice;\n        }\n      });\n      return userOrderTotals;\n    }\n  },\n  mounted() {\n    this.fetchUsersWithAddresses();\n    this.$store.dispatch(\"fetchOrders\");\n    this.$store.dispatch(\"fetchUsers\");\n  },\n  methods: {\n    fetchUsersWithAddresses() {\n      this.$store.dispatch(\"fetchUsersWithAddresses\").catch(error => {\n        console.log(error);\n      });\n    },\n    getLastOrderPrice(userId) {\n      const userOrders = this.orders.filter(order => order.owner === userId);\n      if (userOrders.length > 0) {\n        const lastOrder = userOrders[userOrders.length - 1];\n        return lastOrder.products.reduce((total, product) => {\n          return total + product.totalPrice;\n        }, 0);\n      } else {\n        return 0;\n      }\n    },\n    getTotalMoneySpent(customer) {\n      if (customer.orders && customer.orders.length > 0) {\n        // Sum up the total prices of the customer's orders\n        return customer.orders.reduce((total, order) => {\n          return total + order.products.reduce((subtotal, product) => {\n            return subtotal + product.totalPrice;\n          }, 0);\n        }, 0);\n      } else {\n        return 0;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","computed","usersWithAddresses","getUsersWithAddresses","user","getUsers","orders","getOrders","userOrderTotals","forEach","order","userId","owner","totalPrice","products","reduce","total","product","hasOwnProperty","mounted","fetchUsersWithAddresses","$store","dispatch","methods","catch","error","console","log","getLastOrderPrice","userOrders","filter","length","lastOrder","getTotalMoneySpent","customer","subtotal"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\event-ticket-frontend\\src\\components\\dashboard\\customers.vue"],"sourcesContent":["<template>\r\n  <div class=\"content-boy\">\r\n    <div class=\"\">\r\n      <!-- row -->\r\n      <div class=\"containr-fluid\">\r\n        <div class=\"form-head d-flex mb-3 align-items-start\">\r\n          <div class=\"mr-auto d-none d-lg-block\">\r\n            <h2 class=\"text-black font-w600 mb-0\">General Customers</h2>\r\n            <p class=\"mb-0\">Here is your general customers list data</p>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-12\">\r\n            <div class=\"table-responsive\">\r\n              <table\r\n                id=\"example5\"\r\n                class=\"display mb-4 dataTablesCard\"\r\n\r\n              >\r\n                <thead>\r\n                  <tr>\r\n                    <th>Customer ID</th>\r\n                    <th>Join Date</th>\r\n\r\n                    <th>Customer Name</th>\r\n                    <th>Address</th>\r\n                    <th>Total Spent</th>\r\n                    <th>Last Order</th>\r\n                    <th></th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr   v-for=\"user in getUsers\" :key=\"user._id\"\r\n                  >\r\n                    <td>{{ user._id }}</td>\r\n                    <td>{{ new Date(user.time).toLocaleString() }}</td>\r\n                    <td>{{ user.name }}</td>\r\n                    <td v-if=\"user.address\">{{ user.address.streetAddress  }}</td>\r\n                     <td v-else>N/A</td>\r\n                    <td>{{ userOrderTotals[user._id] ? '$' + userOrderTotals[user._id] : '-' }}</td>\r\n                    <td><span class=\"btn btn-sm light btn-secondary fs-16\">$ {{ getLastOrderPrice(user._id) }}</span></td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\n\r\nexport default {\r\n  computed: {\r\n    ...mapGetters([\"getUsersWithAddresses\", \"getUsers\", \"getOrders\", \"error\"]),\r\n    usersWithAddresses() {\r\n      return this.getUsersWithAddresses;\r\n    },\r\n    user() {\r\n      return this.getUsers;\r\n    },\r\n    orders() {\r\n      return this.getOrders;\r\n    },\r\n    userOrderTotals() {\r\n      // Calculate total order price for each user\r\n      const userOrderTotals = {};\r\n\r\n      this.orders.forEach(order => {\r\n        const userId = order.owner;\r\n        const totalPrice = order.products.reduce((total, product) => {\r\n          return total + product.totalPrice;\r\n        }, 0);\r\n\r\n        if (userOrderTotals.hasOwnProperty(userId)) {\r\n          userOrderTotals[userId] += totalPrice;\r\n        } else {\r\n          userOrderTotals[userId] = totalPrice;\r\n        }\r\n      });\r\n\r\n      return userOrderTotals;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchUsersWithAddresses();\r\n    this.$store.dispatch(\"fetchOrders\");\r\n    this.$store.dispatch(\"fetchUsers\");\r\n  },\r\n  methods: {\r\n    fetchUsersWithAddresses() {\r\n      this.$store.dispatch(\"fetchUsersWithAddresses\").catch(error => {\r\n        console.log(error);\r\n      });\r\n    },\r\n    getLastOrderPrice(userId) {\r\n      const userOrders = this.orders.filter(order => order.owner === userId);\r\n      if (userOrders.length > 0) {\r\n        const lastOrder = userOrders[userOrders.length - 1];\r\n        return lastOrder.products.reduce((total, product) => {\r\n          return total + product.totalPrice;\r\n        }, 0);\r\n      } else {\r\n        return 0;\r\n      }\r\n    },\r\n    getTotalMoneySpent(customer) {\r\n      if (customer.orders && customer.orders.length > 0) {\r\n        // Sum up the total prices of the customer's orders\r\n        return customer.orders.reduce((total, order) => {\r\n          return (\r\n            total +\r\n            order.products.reduce((subtotal, product) => {\r\n              return subtotal + product.totalPrice;\r\n            }, 0)\r\n          );\r\n        }, 0);\r\n      } else {\r\n        return 0;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style>\r\ntd,th {\r\n  padding: 10px;\r\n}\r\n\r\n.customer-row {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n</style>\r\n"],"mappings":"AAuDA,SAASA,UAAS,QAAS,MAAM;AAEjC,eAAe;EACbC,QAAQ,EAAE;IACR,GAAGD,UAAU,CAAC,CAAC,uBAAuB,EAAE,UAAU,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC;IAC1EE,kBAAkBA,CAAA,EAAG;MACnB,OAAO,IAAI,CAACC,qBAAqB;IACnC,CAAC;IACDC,IAAIA,CAAA,EAAG;MACL,OAAO,IAAI,CAACC,QAAQ;IACtB,CAAC;IACDC,MAAMA,CAAA,EAAG;MACP,OAAO,IAAI,CAACC,SAAS;IACvB,CAAC;IACDC,eAAeA,CAAA,EAAG;MAChB;MACA,MAAMA,eAAc,GAAI,CAAC,CAAC;MAE1B,IAAI,CAACF,MAAM,CAACG,OAAO,CAACC,KAAI,IAAK;QAC3B,MAAMC,MAAK,GAAID,KAAK,CAACE,KAAK;QAC1B,MAAMC,UAAS,GAAIH,KAAK,CAACI,QAAQ,CAACC,MAAM,CAAC,CAACC,KAAK,EAAEC,OAAO,KAAK;UAC3D,OAAOD,KAAI,GAAIC,OAAO,CAACJ,UAAU;QACnC,CAAC,EAAE,CAAC,CAAC;QAEL,IAAIL,eAAe,CAACU,cAAc,CAACP,MAAM,CAAC,EAAE;UAC1CH,eAAe,CAACG,MAAM,KAAKE,UAAU;QACvC,OAAO;UACLL,eAAe,CAACG,MAAM,IAAIE,UAAU;QACtC;MACF,CAAC,CAAC;MAEF,OAAOL,eAAe;IACxB;EACF,CAAC;EACDW,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,uBAAuB,CAAC,CAAC;IAC9B,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,aAAa,CAAC;IACnC,IAAI,CAACD,MAAM,CAACC,QAAQ,CAAC,YAAY,CAAC;EACpC,CAAC;EACDC,OAAO,EAAE;IACPH,uBAAuBA,CAAA,EAAG;MACxB,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,yBAAyB,CAAC,CAACE,KAAK,CAACC,KAAI,IAAK;QAC7DC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MACpB,CAAC,CAAC;IACJ,CAAC;IACDG,iBAAiBA,CAACjB,MAAM,EAAE;MACxB,MAAMkB,UAAS,GAAI,IAAI,CAACvB,MAAM,CAACwB,MAAM,CAACpB,KAAI,IAAKA,KAAK,CAACE,KAAI,KAAMD,MAAM,CAAC;MACtE,IAAIkB,UAAU,CAACE,MAAK,GAAI,CAAC,EAAE;QACzB,MAAMC,SAAQ,GAAIH,UAAU,CAACA,UAAU,CAACE,MAAK,GAAI,CAAC,CAAC;QACnD,OAAOC,SAAS,CAAClB,QAAQ,CAACC,MAAM,CAAC,CAACC,KAAK,EAAEC,OAAO,KAAK;UACnD,OAAOD,KAAI,GAAIC,OAAO,CAACJ,UAAU;QACnC,CAAC,EAAE,CAAC,CAAC;MACP,OAAO;QACL,OAAO,CAAC;MACV;IACF,CAAC;IACDoB,kBAAkBA,CAACC,QAAQ,EAAE;MAC3B,IAAIA,QAAQ,CAAC5B,MAAK,IAAK4B,QAAQ,CAAC5B,MAAM,CAACyB,MAAK,GAAI,CAAC,EAAE;QACjD;QACA,OAAOG,QAAQ,CAAC5B,MAAM,CAACS,MAAM,CAAC,CAACC,KAAK,EAAEN,KAAK,KAAK;UAC9C,OACEM,KAAI,GACJN,KAAK,CAACI,QAAQ,CAACC,MAAM,CAAC,CAACoB,QAAQ,EAAElB,OAAO,KAAK;YAC3C,OAAOkB,QAAO,GAAIlB,OAAO,CAACJ,UAAU;UACtC,CAAC,EAAE,CAAC;QAER,CAAC,EAAE,CAAC,CAAC;MACP,OAAO;QACL,OAAO,CAAC;MACV;IACF;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}