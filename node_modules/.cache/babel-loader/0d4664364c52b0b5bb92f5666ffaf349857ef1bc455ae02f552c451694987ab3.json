{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"content-boy\"\n};\nconst _hoisted_2 = {\n  class: \"\"\n};\nconst _hoisted_3 = {\n  class: \"containr-fluid\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"form-head d-flex mb-3 align-items-start\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"mr-auto d-none d-lg-block\"\n}, [/*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"text-black font-w600 mb-0\"\n}, \"General Customers\"), /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"mb-0\"\n}, \"Here is your general customers list data\")])], -1);\nconst _hoisted_5 = {\n  class: \"row\"\n};\nconst _hoisted_6 = {\n  class: \"col-12\"\n};\nconst _hoisted_7 = {\n  class: \"table-responsive\"\n};\nconst _hoisted_8 = {\n  id: \"example5\",\n  class: \"display mb-4 dataTablesCard\"\n};\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"Customer ID\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Join Date\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Customer Name\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Address\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Total Spent\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Last Order\"), /*#__PURE__*/_createElementVNode(\"th\")])], -1);\nconst _hoisted_10 = {\n  key: 0\n};\nconst _hoisted_11 = {\n  key: 1\n};\nconst _hoisted_12 = {\n  class: \"btn btn-sm light btn-secondary fs-16\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"table\", _hoisted_8, [_hoisted_9, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.getUsers, user => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: user._id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(user._id), 1), _createElementVNode(\"td\", null, _toDisplayString(new Date(user.time).toLocaleString()), 1), _createElementVNode(\"td\", null, _toDisplayString(user.name), 1), user.address ? (_openBlock(), _createElementBlock(\"td\", _hoisted_10, _toDisplayString(user.address.streetAddress), 1)) : (_openBlock(), _createElementBlock(\"td\", _hoisted_11, \"N/A\")), _createElementVNode(\"td\", null, _toDisplayString($options.userOrderTotals[user._id] ? '$' + $options.userOrderTotals[user._id] : '-'), 1), _createElementVNode(\"td\", null, [_createElementVNode(\"span\", _hoisted_12, \"$ \" + _toDisplayString($options.getLastOrderPrice(user._id)), 1)])]);\n  }), 128))])])])])])])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","id","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_Fragment","_renderList","_ctx","getUsers","user","key","_id","_toDisplayString","Date","time","toLocaleString","name","address","_hoisted_10","streetAddress","_hoisted_11","$options","userOrderTotals","_hoisted_12","getLastOrderPrice"],"sources":["C:\\Users\\ajib\\OneDrive\\Desktop\\event-ticket\\vue3-restaurant-dashboard\\src\\components\\dashboard\\customers.vue"],"sourcesContent":["<template>\r\n  <div class=\"content-boy\">\r\n    <div class=\"\">\r\n      <!-- row -->\r\n      <div class=\"containr-fluid\">\r\n        <div class=\"form-head d-flex mb-3 align-items-start\">\r\n          <div class=\"mr-auto d-none d-lg-block\">\r\n            <h2 class=\"text-black font-w600 mb-0\">General Customers</h2>\r\n            <p class=\"mb-0\">Here is your general customers list data</p>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-12\">\r\n            <div class=\"table-responsive\">\r\n              <table\r\n                id=\"example5\"\r\n                class=\"display mb-4 dataTablesCard\"\r\n\r\n              >\r\n                <thead>\r\n                  <tr>\r\n                    <th>Customer ID</th>\r\n                    <th>Join Date</th>\r\n\r\n                    <th>Customer Name</th>\r\n                    <th>Address</th>\r\n                    <th>Total Spent</th>\r\n                    <th>Last Order</th>\r\n                    <th></th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr   v-for=\"user in getUsers\" :key=\"user._id\"\r\n                  >\r\n                    <td>{{ user._id }}</td>\r\n                    <td>{{ new Date(user.time).toLocaleString() }}</td>\r\n                    <td>{{ user.name }}</td>\r\n                    <td v-if=\"user.address\">{{ user.address.streetAddress  }}</td>\r\n                     <td v-else>N/A</td>\r\n                    <td>{{ userOrderTotals[user._id] ? '$' + userOrderTotals[user._id] : '-' }}</td>\r\n                    <td><span class=\"btn btn-sm light btn-secondary fs-16\">$ {{ getLastOrderPrice(user._id) }}</span></td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\n\r\nexport default {\r\n  computed: {\r\n    ...mapGetters([\"getUsersWithAddresses\", \"getUsers\", \"getOrders\", \"error\"]),\r\n    usersWithAddresses() {\r\n      return this.getUsersWithAddresses;\r\n    },\r\n    user() {\r\n      return this.getUsers;\r\n    },\r\n    orders() {\r\n      return this.getOrders;\r\n    },\r\n    userOrderTotals() {\r\n      // Calculate total order price for each user\r\n      const userOrderTotals = {};\r\n\r\n      this.orders.forEach(order => {\r\n        const userId = order.owner;\r\n        const totalPrice = order.products.reduce((total, product) => {\r\n          return total + product.totalPrice;\r\n        }, 0);\r\n\r\n        if (userOrderTotals.hasOwnProperty(userId)) {\r\n          userOrderTotals[userId] += totalPrice;\r\n        } else {\r\n          userOrderTotals[userId] = totalPrice;\r\n        }\r\n      });\r\n\r\n      return userOrderTotals;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchUsersWithAddresses();\r\n    this.$store.dispatch(\"fetchOrders\");\r\n    this.$store.dispatch(\"fetchUsers\");\r\n  },\r\n  methods: {\r\n    fetchUsersWithAddresses() {\r\n      this.$store.dispatch(\"fetchUsersWithAddresses\").catch(error => {\r\n        console.log(error);\r\n      });\r\n    },\r\n    getLastOrderPrice(userId) {\r\n      const userOrders = this.orders.filter(order => order.owner === userId);\r\n      if (userOrders.length > 0) {\r\n        const lastOrder = userOrders[userOrders.length - 1];\r\n        return lastOrder.products.reduce((total, product) => {\r\n          return total + product.totalPrice;\r\n        }, 0);\r\n      } else {\r\n        return 0;\r\n      }\r\n    },\r\n    getTotalMoneySpent(customer) {\r\n      if (customer.orders && customer.orders.length > 0) {\r\n        // Sum up the total prices of the customer's orders\r\n        return customer.orders.reduce((total, order) => {\r\n          return (\r\n            total +\r\n            order.products.reduce((subtotal, product) => {\r\n              return subtotal + product.totalPrice;\r\n            }, 0)\r\n          );\r\n        }, 0);\r\n      } else {\r\n        return 0;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style>\r\ntd,th {\r\n  padding: 10px;\r\n}\r\n\r\n.customer-row {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAa;;EACjBA,KAAK,EAAC;AAAE;;EAENA,KAAK,EAAC;AAAgB;gCACzBC,mBAAA,CAMM;EANDD,KAAK,EAAC;AAAyC,I,aAClDC,mBAAA,CAGM;EAHDD,KAAK,EAAC;AAA2B,I,aACpCC,mBAAA,CAA4D;EAAxDD,KAAK,EAAC;AAA2B,GAAC,mBAAiB,G,aACvDC,mBAAA,CAA4D;EAAzDD,KAAK,EAAC;AAAM,GAAC,0CAAwC,E;;EAKvDA,KAAK,EAAC;AAAK;;EACTA,KAAK,EAAC;AAAQ;;EACZA,KAAK,EAAC;AAAkB;;EAEzBE,EAAE,EAAC,UAAU;EACbF,KAAK,EAAC;;gCAGNC,mBAAA,CAWQ,gB,aAVNA,mBAAA,CASK,a,aARHA,mBAAA,CAAoB,YAAhB,aAAW,G,aACfA,mBAAA,CAAkB,YAAd,WAAS,G,aAEbA,mBAAA,CAAsB,YAAlB,eAAa,G,aACjBA,mBAAA,CAAgB,YAAZ,SAAO,G,aACXA,mBAAA,CAAoB,YAAhB,aAAW,G,aACfA,mBAAA,CAAmB,YAAf,YAAU,G,aACdA,mBAAA,CAAS,M;;;;;;;;EAYCD,KAAK,EAAC;AAAsC;;uBAzCxEG,mBAAA,CAmDM,OAnDNC,UAmDM,GAlDJH,mBAAA,CAiDM,OAjDNI,UAiDM,GA/CJJ,mBAAA,CA8CM,OA9CNK,UA8CM,GA7CJC,UAMM,EAENN,mBAAA,CAmCM,OAnCNO,UAmCM,GAlCJP,mBAAA,CAiCM,OAjCNQ,UAiCM,GAhCJR,mBAAA,CA+BM,OA/BNS,UA+BM,GA9BJT,mBAAA,CA6BQ,SA7BRU,UA6BQ,GAxBNC,UAWQ,EACRX,mBAAA,CAWQ,iB,kBAVNE,mBAAA,CASKU,SAAA,QAAAC,WAAA,CATgBC,IAAA,CAAAC,QAAQ,EAAhBC,IAAI;yBAAjBd,mBAAA,CASK;MAT2Be,GAAG,EAAED,IAAI,CAACE;QAExClB,mBAAA,CAAuB,YAAAmB,gBAAA,CAAhBH,IAAI,CAACE,GAAG,OACflB,mBAAA,CAAmD,YAAAmB,gBAAA,KAAxCC,IAAI,CAACJ,IAAI,CAACK,IAAI,EAAEC,cAAc,SACzCtB,mBAAA,CAAwB,YAAAmB,gBAAA,CAAjBH,IAAI,CAACO,IAAI,OACNP,IAAI,CAACQ,OAAO,I,cAAtBtB,mBAAA,CAA8D,MAAAuB,WAAA,EAAAN,gBAAA,CAAnCH,IAAI,CAACQ,OAAO,CAACE,aAAa,U,cACpDxB,mBAAA,CAAmB,MAAAyB,WAAA,EAAR,KAAG,IACf3B,mBAAA,CAAgF,YAAAmB,gBAAA,CAAzES,QAAA,CAAAC,eAAe,CAACb,IAAI,CAACE,GAAG,UAAUU,QAAA,CAAAC,eAAe,CAACb,IAAI,CAACE,GAAG,cACjElB,mBAAA,CAAsG,aAAlGA,mBAAA,CAA6F,QAA7F8B,WAA6F,EAA1C,IAAE,GAAAX,gBAAA,CAAGS,QAAA,CAAAG,iBAAiB,CAACf,IAAI,CAACE,GAAG,O"},"metadata":{},"sourceType":"module","externalDependencies":[]}